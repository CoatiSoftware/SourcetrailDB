version: 0.0.0.{build}


image: 
    - Visual Studio 2017
    - Ubuntu
    - macos


environment:
    PYTHON_BINDINGS: 0
    JAVA_BINDINGS: 0
    PERL_BINDINGS: 0
    

platform: x64


configuration: Release


for:
-
    matrix:
        only:
            - image: Visual Studio 2017
    install:
    - cmd: |
        echo Building on Windows!
        echo Python: %PYTHON_BINDINGS%
        echo Java: %JAVA_BINDINGS%
        echo Perl: %PERL_BINDINGS%
        
    build_script:
    - cmd: echo Python - %PYTHON_BINDINGS%
-
    matrix:
        only:
            - image: Ubuntu
    install:
    - sh: |
        echo Building on Ubuntu!
        echo Python: $PYTHON_BINDINGS
        echo Java: $JAVA_BINDINGS
        echo Perl: $PERL_BINDINGS
        #sudo apt-get update
        #sudo apt-get install -qq swig
    build_script:
    - sh: |
        mkdir build
        cd build  
        cmake -DBUILD_BINDINGS_PERL=$PERL_BINDINGS -DBUILD_BINDINGS_PYTHON=$PYTHON_BINDINGS  -DBUILD_BINDINGS_JAVA=$JAVA_BINDINGS ..
        make
        ./core/test_core
-
    matrix:
        only:
            - image: macos
    install:
    - sh: |
        echo Python: $PYTHON_BINDINGS
        echo Java: $JAVA_BINDINGS
        echo Perl: $PERL_BINDINGS
        #HOMEBREW_NO_AUTO_UPDATE=1 brew install swig
        #brew link --force swig

    build_script:
    - sh: echo Building on Mac OS!
    - sh: |
        mkdir build
        cd build  
        cmake -DBUILD_BINDINGS_PERL=$PERL_BINDINGS -DBUILD_BINDINGS_PYTHON=$PYTHON_BINDINGS  -DBUILD_BINDINGS_JAVA=$JAVA_BINDINGS ..
        make
        ./core/test_core


build_script:
    - echo ERROR - Empty default script was executed!
    - exit 1
